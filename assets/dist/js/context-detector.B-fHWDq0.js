var __defProp=Object.defineProperty;var __name=(target,value)=>__defProp(target,"name",{value,configurable:!0});const _ClientTypeChecker=class _ClientTypeChecker{constructor(config){this.config=config,this.initializeCheck()}timedOut=!1;img=new Image;timer=null;initializeCheck(){const storedResult=sessionStorage.getItem("brokenLinkClientType");storedResult?this.applyStoredResult(storedResult):(this.setTimer(),this.loadImage())}applyStoredResult(result){result==="internal"?this.setInternalClient():result==="external"&&this.setExternalClient()}setTimer(){this.timer=window.setTimeout(()=>{this.timedOut=!0,this.cancelImageLoad(),this.setExternalClient()},this.config.checkTimeout)}loadImage(){this.img.onload=this.handleImageLoad,this.img.onerror=this.handleImageError,this.img.src=this.config.checkUrl}handleImageLoad=__name(()=>{this.timedOut||(this.clearTimer(),this.setInternalClient())},"handleImageLoad");handleImageError=__name(()=>{this.timedOut||(this.clearTimer(),this.setExternalClient())},"handleImageError");clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=null)}cancelImageLoad(){this.img.src=""}setInternalClient(){document.dispatchEvent(new CustomEvent("brokenLinkContextDetectionInternal")),document.body.classList.add(this.config.successClass),sessionStorage.setItem("brokenLinkClientType","internal")}setExternalClient(){document.dispatchEvent(new CustomEvent("brokenLinkContextDetectionExternal")),document.body.classList.add(this.config.failedClass),this.applyDomainRestrictions(),sessionStorage.setItem("brokenLinkClientType","external")}applyDomainRestrictions(){this.config.domains.forEach(domain=>{document.querySelectorAll(`a[href*="${domain}"]`).forEach(element=>{this.addUnavailableClass(element),this.preventDefaultOnClick(element),this.config.isToolTipActive&&this.addTooltip(element),this.config.isModalActive&&this.addModalAttributes(element)})}),this.reindexModals()}addUnavailableClass(element){element.classList.add("broken-link-detector-link-is-unavailable")}preventDefaultOnClick(element){element.addEventListener("click",event=>{event.preventDefault()})}addTooltip(element){element.setAttribute("data-tooltip",this.config.tooltip)}addModalAttributes(element){element.setAttribute("data-open","modal-broken-link"),element.addEventListener("click",()=>{const modalButton=document.getElementById("modal-broken-link-button");modalButton&&modalButton.setAttribute("href",element.getAttribute("href")||"#linknotfound")})}reindexModals(){document.dispatchEvent(new CustomEvent("reindexModals"))}};__name(_ClientTypeChecker,"ClientTypeChecker");let ClientTypeChecker=_ClientTypeChecker;function initializeClientTypeChecker(brokenLinkContextDetectionData2){document.addEventListener("DOMContentLoaded",()=>{new ClientTypeChecker(brokenLinkContextDetectionData2)})}__name(initializeClientTypeChecker,"initializeClientTypeChecker");initializeClientTypeChecker(brokenLinkContextDetectionData);
//# sourceMappingURL=context-detector.B-fHWDq0.js.map

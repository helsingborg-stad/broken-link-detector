(()=>{"use strict";(()=>{class t{constructor(t){this.config=t,this.timedOut=!1,this.img=new Image,this.timer=null,this.handleImageLoad=()=>{this.timedOut||(this.clearTimer(),this.setInternalClient())},this.handleImageError=()=>{this.timedOut||(this.clearTimer(),this.setExternalClient())},this.initializeCheck()}initializeCheck(){const t=sessionStorage.getItem("brokenLinkClientType");t?this.applyStoredResult(t):(this.setTimer(),this.loadImage())}applyStoredResult(t){"internal"===t?this.setInternalClient():"external"===t&&this.setExternalClient()}setTimer(){this.timer=window.setTimeout(()=>{this.timedOut=!0,this.cancelImageLoad(),this.setExternalClient()},this.config.checkTimeout)}loadImage(){this.img.onload=this.handleImageLoad,this.img.onerror=this.handleImageError,this.img.src=this.config.checkUrl}clearTimer(){this.timer&&(clearTimeout(this.timer),this.timer=null)}cancelImageLoad(){this.img.src=""}setInternalClient(){document.dispatchEvent(new CustomEvent("brokenLinkContextDetectionInternal")),document.body.classList.add(this.config.successClass),sessionStorage.setItem("brokenLinkClientType","internal")}setExternalClient(){document.dispatchEvent(new CustomEvent("brokenLinkContextDetectionExternal")),document.body.classList.add(this.config.failedClass),this.applyDomainRestrictions(),sessionStorage.setItem("brokenLinkClientType","external")}applyDomainRestrictions(){this.config.domains.forEach(t=>{document.querySelectorAll(`a[href*="${t}"]`).forEach(t=>{this.addUnavailableClass(t),this.preventDefaultOnClick(t),this.config.isToolTipActive&&this.addTooltip(t),this.config.isModalActive&&this.addModalAttributes(t)})}),this.reindexModals()}addUnavailableClass(t){t.classList.add("broken-link-detector-link-is-unavailable")}preventDefaultOnClick(t){t.addEventListener("click",t=>{t.preventDefault()})}addTooltip(t){t.setAttribute("data-tooltip",this.config.tooltip)}addModalAttributes(t){t.setAttribute("data-open","modal-broken-link"),t.addEventListener("click",()=>{const e=document.getElementById("modal-broken-link-button");e&&e.setAttribute("href",t.getAttribute("href")||"#linknotfound")})}reindexModals(){document.dispatchEvent(new CustomEvent("reindexModals"))}}!function(e){document.addEventListener("DOMContentLoaded",()=>{new t(e)})}(brokenLinkContextDetectionData)})()})();
//# sourceMappingURL=context-detector.3361defc466a8be32f8f.js.map